<h1 class="mb-4">ðŸŽŸ My Bookings</h1>

<table class="table table-striped table-bordered align-middle">
  <thead class="table-dark text-center">
    <tr>
      <th>Movie</th>
      <th>Theatre</th>
      <th>Showtime</th>
      <th>Seat</th>
      <th>Price</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <% if @bookings.any? %>
      <% @bookings.each do |booking| %>
        <tr>
          <td><%= booking.show&.movie&.title || "N/A" %></td>
          <td><%= booking.show&.theatre&.name || "N/A" %></td>
          <td>
            <% if booking.show&.start_time.present? %>
              <%= booking.show.start_time.strftime("%d %b %Y %I:%M %p") %>
            <% else %>
              N/A
            <% end %>
          </td>
          <td><%= booking.seat&.seat_number || "N/A" %></td>
          <td><%= number_to_currency(booking.total_price || booking.show&.ticket_price, unit: "â‚¹") %></td>
          <td>
            <% if booking.seat.present? %>
              <% if booking.seat.available? %>
                <span class="badge bg-success">Available</span>
              <% else %>
                <span class="badge bg-danger">Booked</span>
              <% end %>
            <% else %>
              <span class="badge bg-secondary">Pending</span>
            <% end %>
          </td>
          <td class="text-center">
            <% if booking.seat.present? && !booking.seat.available? %>
              <%= link_to "Cancel", booking_path(booking),
                          method: :delete,
                          data: { confirm: "Are you sure you want to cancel this booking?" },
                          class: "btn btn-sm btn-danger" %>
            <% else %>
              <span class="text-muted">â€”</span>
            <% end %>
          </td>
        </tr>
      <% end %>
    <% else %>
      <tr>
        <td colspan="7" class="text-center text-muted">You donâ€™t have any bookings yet.</td>
      </tr>
    <% end %>
  </tbody>
</table>
